{"version":3,"sources":["webpack://vue-admin2-[name]/./src/view/excel/upload-excel.vue?0209","webpack://vue-admin2-[name]/src/view/excel/upload-excel.vue","webpack://vue-admin2-[name]/./src/view/excel/upload-excel.vue?c338","webpack://vue-admin2-[name]/./src/view/excel/upload-excel.vue","webpack://vue-admin2-[name]/./src/view/excel/upload-excel.vue?5951"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","handleBeforeUpload","uploadLoading","on","handleUploadFile","_v","file","staticClass","_s","name","directives","rawName","value","expression","nativeOn","$event","handleRemove","_e","progressPercent","tableTitle","tableData","tableLoading","staticRenderFns","data","showProgress","showRemoveFile","methods","initUpload","loadingProgress","$Message","info","fileExt","readFile","$Notice","warning","title","desc","reader","readAsArrayBuffer","onloadstart","onprogress","onerror","onload","created","mounted","component"],"mappings":"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","file":"static/js/chunk-253d831c.264dc720.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Card',{attrs:{\"title\":\"导入EXCEL\"}},[_c('Row',[_c('Upload',{attrs:{\"action\":\"\",\"before-upload\":_vm.handleBeforeUpload,\"accept\":\".xls, .xlsx\"}},[_c('Button',{attrs:{\"icon\":\"ios-cloud-upload-outline\",\"loading\":_vm.uploadLoading},on:{\"click\":_vm.handleUploadFile}},[_vm._v(\"上传文件\")])],1)],1),_c('Row',[(_vm.file !== null)?_c('div',{staticClass:\"ivu-upload-list-file\"},[_c('Icon',{attrs:{\"type\":\"ios-stats\"}}),_vm._v(\"\\n          \"+_vm._s(_vm.file.name)+\"\\n        \"),_c('Icon',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showRemoveFile),expression:\"showRemoveFile\"}],staticClass:\"ivu-upload-list-remove\",attrs:{\"type\":\"ios-close\"},nativeOn:{\"click\":function($event){return _vm.handleRemove()}}})],1):_vm._e()]),_c('Row',[_c('transition',{attrs:{\"name\":\"fade\"}},[(_vm.showProgress)?_c('Progress',{attrs:{\"percent\":_vm.progressPercent,\"stroke-width\":2}},[(_vm.progressPercent == 100)?_c('div',[_c('Icon',{attrs:{\"type\":\"ios-checkmark-circle\"}}),_c('span',[_vm._v(\"成功\")])],1):_vm._e()]):_vm._e()],1)],1)],1),_c('Row',{staticClass:\"margin-top-10\"},[_c('Table',{attrs:{\"columns\":_vm.tableTitle,\"data\":_vm.tableData,\"loading\":_vm.tableLoading}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<style lang=\"less\">\n  @import \"./common.less\";\n</style>\n<template>\n  <div>\n    <Card title=\"导入EXCEL\">\n      <Row>\n        <Upload action=\"\" :before-upload=\"handleBeforeUpload\" accept=\".xls, .xlsx\">\n          <Button icon=\"ios-cloud-upload-outline\" :loading=\"uploadLoading\" @click=\"handleUploadFile\">上传文件</Button>\n        </Upload>\n      </Row>\n      <Row>\n        <div class=\"ivu-upload-list-file\" v-if=\"file !== null\">\n          <Icon type=\"ios-stats\"></Icon>\n            {{ file.name }}\n          <Icon v-show=\"showRemoveFile\" type=\"ios-close\" class=\"ivu-upload-list-remove\" @click.native=\"handleRemove()\"></Icon>\n        </div>\n      </Row>\n      <Row>\n        <transition name=\"fade\">\n          <Progress v-if=\"showProgress\" :percent=\"progressPercent\" :stroke-width=\"2\">\n            <div v-if=\"progressPercent == 100\">\n              <Icon type=\"ios-checkmark-circle\"></Icon>\n              <span>成功</span>\n            </div>\n          </Progress>\n        </transition>\n      </Row>\n    </Card>\n    <Row class=\"margin-top-10\">\n      <Table :columns=\"tableTitle\" :data=\"tableData\" :loading=\"tableLoading\"></Table>\n    </Row>\n  </div>\n</template>\n<script>\nimport excel from '@/libs/excel'\nexport default {\n  name: 'upload-excel',\n  data () {\n    return {\n      uploadLoading: false,\n      progressPercent: 0,\n      showProgress: false,\n      showRemoveFile: false,\n      file: null,\n      tableData: [],\n      tableTitle: [],\n      tableLoading: false\n    }\n  },\n  methods: {\n    initUpload () {\n      this.file = null\n      this.showProgress = false\n      this.loadingProgress = 0\n      this.tableData = []\n      this.tableTitle = []\n    },\n    handleUploadFile () {\n      this.initUpload()\n    },\n    handleRemove () {\n      this.initUpload()\n      this.$Message.info('上传的文件已删除！')\n    },\n    handleBeforeUpload (file) {\n      const fileExt = file.name.split('.').pop().toLocaleLowerCase()\n      if (fileExt === 'xlsx' || fileExt === 'xls') {\n        this.readFile(file)\n        this.file = file\n      } else {\n        this.$Notice.warning({\n          title: '文件类型错误',\n          desc: '文件：' + file.name + '不是EXCEL文件，请选择后缀为.xlsx或者.xls的EXCEL文件。'\n        })\n      }\n      return false\n    },\n    // 读取文件\n    readFile (file) {\n      const reader = new FileReader()\n      reader.readAsArrayBuffer(file)\n      reader.onloadstart = e => {\n        this.uploadLoading = true\n        this.tableLoading = true\n        this.showProgress = true\n      }\n      reader.onprogress = e => {\n        this.progressPercent = Math.round(e.loaded / e.total * 100)\n      }\n      reader.onerror = e => {\n        this.$Message.error('文件读取出错')\n      }\n      reader.onload = e => {\n        this.$Message.info('文件读取成功')\n        const data = e.target.result\n        const { header, results } = excel.read(data, 'array')\n        const tableTitle = header.map(item => { return { title: item, key: item } })\n        this.tableData = results\n        this.tableTitle = tableTitle\n        this.uploadLoading = false\n        this.tableLoading = false\n        this.showRemoveFile = true\n      }\n    }\n  },\n  created () {\n\n  },\n  mounted () {\n\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./upload-excel.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./upload-excel.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./upload-excel.vue?vue&type=template&id=29dd89ae&\"\nimport script from \"./upload-excel.vue?vue&type=script&lang=js&\"\nexport * from \"./upload-excel.vue?vue&type=script&lang=js&\"\nimport style0 from \"./upload-excel.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./upload-excel.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./upload-excel.vue?vue&type=style&index=0&lang=less&\""],"sourceRoot":""}